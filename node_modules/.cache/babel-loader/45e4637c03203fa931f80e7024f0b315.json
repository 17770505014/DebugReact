{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { accumulateEnterLeaveDispatches } from 'legacy-events/EventPropagators';\nimport { TOP_MOUSE_OUT, TOP_MOUSE_OVER, TOP_POINTER_OUT, TOP_POINTER_OVER } from './DOMTopLevelEventTypes';\nimport SyntheticMouseEvent from './SyntheticMouseEvent';\nimport SyntheticPointerEvent from './SyntheticPointerEvent';\nimport { getClosestInstanceFromNode, getNodeFromInstance } from '../client/ReactDOMComponentTree';\nimport { HostComponent, HostText } from 'shared/ReactWorkTags';\nconst eventTypes = {\n  mouseEnter: {\n    registrationName: 'onMouseEnter',\n    dependencies: [TOP_MOUSE_OUT, TOP_MOUSE_OVER]\n  },\n  mouseLeave: {\n    registrationName: 'onMouseLeave',\n    dependencies: [TOP_MOUSE_OUT, TOP_MOUSE_OVER]\n  },\n  pointerEnter: {\n    registrationName: 'onPointerEnter',\n    dependencies: [TOP_POINTER_OUT, TOP_POINTER_OVER]\n  },\n  pointerLeave: {\n    registrationName: 'onPointerLeave',\n    dependencies: [TOP_POINTER_OUT, TOP_POINTER_OVER]\n  }\n};\nconst EnterLeaveEventPlugin = {\n  eventTypes: eventTypes,\n\n  /**\n   * For almost every interaction we care about, there will be both a top-level\n   * `mouseover` and `mouseout` event that occurs. Only use `mouseout` so that\n   * we do not extract duplicate events. However, moving the mouse into the\n   * browser from outside will not fire a `mouseout` event. In this case, we use\n   * the `mouseover` top-level event.\n   */\n  extractEvents: function (topLevelType, targetInst, nativeEvent, nativeEventTarget) {\n    const isOverEvent = topLevelType === TOP_MOUSE_OVER || topLevelType === TOP_POINTER_OVER;\n    const isOutEvent = topLevelType === TOP_MOUSE_OUT || topLevelType === TOP_POINTER_OUT;\n\n    if (isOverEvent && (nativeEvent.relatedTarget || nativeEvent.fromElement)) {\n      return null;\n    }\n\n    if (!isOutEvent && !isOverEvent) {\n      // Must not be a mouse or pointer in or out - ignoring.\n      return null;\n    }\n\n    let win;\n\n    if (nativeEventTarget.window === nativeEventTarget) {\n      // `nativeEventTarget` is probably a window object.\n      win = nativeEventTarget;\n    } else {\n      // TODO: Figure out why `ownerDocument` is sometimes undefined in IE8.\n      const doc = nativeEventTarget.ownerDocument;\n\n      if (doc) {\n        win = doc.defaultView || doc.parentWindow;\n      } else {\n        win = window;\n      }\n    }\n\n    let from;\n    let to;\n\n    if (isOutEvent) {\n      from = targetInst;\n      const related = nativeEvent.relatedTarget || nativeEvent.toElement;\n      to = related ? getClosestInstanceFromNode(related) : null;\n\n      if (to !== null && to.tag !== HostComponent && to.tag !== HostText) {\n        to = null;\n      }\n    } else {\n      // Moving to a node from outside the window.\n      from = null;\n      to = targetInst;\n    }\n\n    if (from === to) {\n      // Nothing pertains to our managed components.\n      return null;\n    }\n\n    let eventInterface, leaveEventType, enterEventType, eventTypePrefix;\n\n    if (topLevelType === TOP_MOUSE_OUT || topLevelType === TOP_MOUSE_OVER) {\n      eventInterface = SyntheticMouseEvent;\n      leaveEventType = eventTypes.mouseLeave;\n      enterEventType = eventTypes.mouseEnter;\n      eventTypePrefix = 'mouse';\n    } else if (topLevelType === TOP_POINTER_OUT || topLevelType === TOP_POINTER_OVER) {\n      eventInterface = SyntheticPointerEvent;\n      leaveEventType = eventTypes.pointerLeave;\n      enterEventType = eventTypes.pointerEnter;\n      eventTypePrefix = 'pointer';\n    }\n\n    const fromNode = from == null ? win : getNodeFromInstance(from);\n    const toNode = to == null ? win : getNodeFromInstance(to);\n    const leave = eventInterface.getPooled(leaveEventType, from, nativeEvent, nativeEventTarget);\n    leave.type = eventTypePrefix + 'leave';\n    leave.target = fromNode;\n    leave.relatedTarget = toNode;\n    const enter = eventInterface.getPooled(enterEventType, to, nativeEvent, nativeEventTarget);\n    enter.type = eventTypePrefix + 'enter';\n    enter.target = toNode;\n    enter.relatedTarget = fromNode;\n    accumulateEnterLeaveDispatches(leave, enter, from, to);\n    return [leave, enter];\n  }\n};\nexport default EnterLeaveEventPlugin;","map":{"version":3,"sources":["/Users/gaoshaoyun/Documents/library/debug-react/src/react/packages/react-dom/src/events/EnterLeaveEventPlugin.js"],"names":["accumulateEnterLeaveDispatches","TOP_MOUSE_OUT","TOP_MOUSE_OVER","TOP_POINTER_OUT","TOP_POINTER_OVER","SyntheticMouseEvent","SyntheticPointerEvent","getClosestInstanceFromNode","getNodeFromInstance","HostComponent","HostText","eventTypes","mouseEnter","registrationName","dependencies","mouseLeave","pointerEnter","pointerLeave","EnterLeaveEventPlugin","extractEvents","topLevelType","targetInst","nativeEvent","nativeEventTarget","isOverEvent","isOutEvent","relatedTarget","fromElement","win","window","doc","ownerDocument","defaultView","parentWindow","from","to","related","toElement","tag","eventInterface","leaveEventType","enterEventType","eventTypePrefix","fromNode","toNode","leave","getPooled","type","target","enter"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport {accumulateEnterLeaveDispatches} from 'legacy-events/EventPropagators';\n\nimport {\n  TOP_MOUSE_OUT,\n  TOP_MOUSE_OVER,\n  TOP_POINTER_OUT,\n  TOP_POINTER_OVER,\n} from './DOMTopLevelEventTypes';\nimport SyntheticMouseEvent from './SyntheticMouseEvent';\nimport SyntheticPointerEvent from './SyntheticPointerEvent';\nimport {\n  getClosestInstanceFromNode,\n  getNodeFromInstance,\n} from '../client/ReactDOMComponentTree';\nimport {HostComponent, HostText} from 'shared/ReactWorkTags';\n\nconst eventTypes = {\n  mouseEnter: {\n    registrationName: 'onMouseEnter',\n    dependencies: [TOP_MOUSE_OUT, TOP_MOUSE_OVER],\n  },\n  mouseLeave: {\n    registrationName: 'onMouseLeave',\n    dependencies: [TOP_MOUSE_OUT, TOP_MOUSE_OVER],\n  },\n  pointerEnter: {\n    registrationName: 'onPointerEnter',\n    dependencies: [TOP_POINTER_OUT, TOP_POINTER_OVER],\n  },\n  pointerLeave: {\n    registrationName: 'onPointerLeave',\n    dependencies: [TOP_POINTER_OUT, TOP_POINTER_OVER],\n  },\n};\n\nconst EnterLeaveEventPlugin = {\n  eventTypes: eventTypes,\n\n  /**\n   * For almost every interaction we care about, there will be both a top-level\n   * `mouseover` and `mouseout` event that occurs. Only use `mouseout` so that\n   * we do not extract duplicate events. However, moving the mouse into the\n   * browser from outside will not fire a `mouseout` event. In this case, we use\n   * the `mouseover` top-level event.\n   */\n  extractEvents: function(\n    topLevelType,\n    targetInst,\n    nativeEvent,\n    nativeEventTarget,\n  ) {\n    const isOverEvent =\n      topLevelType === TOP_MOUSE_OVER || topLevelType === TOP_POINTER_OVER;\n    const isOutEvent =\n      topLevelType === TOP_MOUSE_OUT || topLevelType === TOP_POINTER_OUT;\n\n    if (isOverEvent && (nativeEvent.relatedTarget || nativeEvent.fromElement)) {\n      return null;\n    }\n\n    if (!isOutEvent && !isOverEvent) {\n      // Must not be a mouse or pointer in or out - ignoring.\n      return null;\n    }\n\n    let win;\n    if (nativeEventTarget.window === nativeEventTarget) {\n      // `nativeEventTarget` is probably a window object.\n      win = nativeEventTarget;\n    } else {\n      // TODO: Figure out why `ownerDocument` is sometimes undefined in IE8.\n      const doc = nativeEventTarget.ownerDocument;\n      if (doc) {\n        win = doc.defaultView || doc.parentWindow;\n      } else {\n        win = window;\n      }\n    }\n\n    let from;\n    let to;\n    if (isOutEvent) {\n      from = targetInst;\n      const related = nativeEvent.relatedTarget || nativeEvent.toElement;\n      to = related ? getClosestInstanceFromNode(related) : null;\n      if (to !== null && to.tag !== HostComponent && to.tag !== HostText) {\n        to = null;\n      }\n    } else {\n      // Moving to a node from outside the window.\n      from = null;\n      to = targetInst;\n    }\n\n    if (from === to) {\n      // Nothing pertains to our managed components.\n      return null;\n    }\n\n    let eventInterface, leaveEventType, enterEventType, eventTypePrefix;\n\n    if (topLevelType === TOP_MOUSE_OUT || topLevelType === TOP_MOUSE_OVER) {\n      eventInterface = SyntheticMouseEvent;\n      leaveEventType = eventTypes.mouseLeave;\n      enterEventType = eventTypes.mouseEnter;\n      eventTypePrefix = 'mouse';\n    } else if (\n      topLevelType === TOP_POINTER_OUT ||\n      topLevelType === TOP_POINTER_OVER\n    ) {\n      eventInterface = SyntheticPointerEvent;\n      leaveEventType = eventTypes.pointerLeave;\n      enterEventType = eventTypes.pointerEnter;\n      eventTypePrefix = 'pointer';\n    }\n\n    const fromNode = from == null ? win : getNodeFromInstance(from);\n    const toNode = to == null ? win : getNodeFromInstance(to);\n\n    const leave = eventInterface.getPooled(\n      leaveEventType,\n      from,\n      nativeEvent,\n      nativeEventTarget,\n    );\n    leave.type = eventTypePrefix + 'leave';\n    leave.target = fromNode;\n    leave.relatedTarget = toNode;\n\n    const enter = eventInterface.getPooled(\n      enterEventType,\n      to,\n      nativeEvent,\n      nativeEventTarget,\n    );\n    enter.type = eventTypePrefix + 'enter';\n    enter.target = toNode;\n    enter.relatedTarget = fromNode;\n\n    accumulateEnterLeaveDispatches(leave, enter, from, to);\n\n    return [leave, enter];\n  },\n};\n\nexport default EnterLeaveEventPlugin;\n"]},"metadata":{},"sourceType":"module"}