{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n */\nimport warningWithoutStack from 'shared/warningWithoutStack';\nconst valueStack = [];\nlet fiberStack;\n\nif (__DEV__) {\n  fiberStack = [];\n}\n\nlet index = -1;\n\nfunction createCursor(defaultValue) {\n  return {\n    current: defaultValue\n  };\n}\n\nfunction isEmpty() {\n  return index === -1;\n}\n\nfunction pop(cursor, fiber) {\n  if (index < 0) {\n    if (__DEV__) {\n      warningWithoutStack(false, 'Unexpected pop.');\n    }\n\n    return;\n  }\n\n  if (__DEV__) {\n    if (fiber !== fiberStack[index]) {\n      warningWithoutStack(false, 'Unexpected Fiber popped.');\n    }\n  }\n\n  cursor.current = valueStack[index];\n  valueStack[index] = null;\n\n  if (__DEV__) {\n    fiberStack[index] = null;\n  }\n\n  index--;\n}\n\nfunction push(cursor, value, fiber) {\n  index++;\n  valueStack[index] = cursor.current;\n\n  if (__DEV__) {\n    fiberStack[index] = fiber;\n  }\n\n  cursor.current = value;\n}\n\nfunction checkThatStackIsEmpty() {\n  if (__DEV__) {\n    if (index !== -1) {\n      warningWithoutStack(false, 'Expected an empty stack. Something was not reset properly.');\n    }\n  }\n}\n\nfunction resetStackAfterFatalErrorInDev() {\n  if (__DEV__) {\n    index = -1;\n    valueStack.length = 0;\n    fiberStack.length = 0;\n  }\n}\n\nexport { createCursor, isEmpty, pop, push, // DEV only:\ncheckThatStackIsEmpty, resetStackAfterFatalErrorInDev };","map":{"version":3,"sources":["/Users/gaoshaoyun/Documents/library/debug-react/src/react/packages/react-reconciler/src/ReactFiberStack.js"],"names":["warningWithoutStack","valueStack","fiberStack","__DEV__","index","createCursor","defaultValue","current","isEmpty","pop","cursor","fiber","push","value","checkThatStackIsEmpty","resetStackAfterFatalErrorInDev","length"],"mappings":"AAAA;;;;;;;;AAWA,OAAOA,mBAAP,MAAgC,4BAAhC;AAMA,MAAMC,UAAsB,GAAG,EAA/B;AAEA,IAAIC,UAAJ;;AAEA,IAAIC,OAAJ,EAAa;AACXD,EAAAA,UAAU,GAAG,EAAb;AACD;;AAED,IAAIE,KAAK,GAAG,CAAC,CAAb;;AAEA,SAASC,YAAT,CAAyBC,YAAzB,EAA0D;AACxD,SAAO;AACLC,IAAAA,OAAO,EAAED;AADJ,GAAP;AAGD;;AAED,SAASE,OAAT,GAA4B;AAC1B,SAAOJ,KAAK,KAAK,CAAC,CAAlB;AACD;;AAED,SAASK,GAAT,CAAgBC,MAAhB,EAAwCC,KAAxC,EAA4D;AAC1D,MAAIP,KAAK,GAAG,CAAZ,EAAe;AACb,QAAID,OAAJ,EAAa;AACXH,MAAAA,mBAAmB,CAAC,KAAD,EAAQ,iBAAR,CAAnB;AACD;;AACD;AACD;;AAED,MAAIG,OAAJ,EAAa;AACX,QAAIQ,KAAK,KAAKT,UAAU,CAACE,KAAD,CAAxB,EAAiC;AAC/BJ,MAAAA,mBAAmB,CAAC,KAAD,EAAQ,0BAAR,CAAnB;AACD;AACF;;AAEDU,EAAAA,MAAM,CAACH,OAAP,GAAiBN,UAAU,CAACG,KAAD,CAA3B;AAEAH,EAAAA,UAAU,CAACG,KAAD,CAAV,GAAoB,IAApB;;AAEA,MAAID,OAAJ,EAAa;AACXD,IAAAA,UAAU,CAACE,KAAD,CAAV,GAAoB,IAApB;AACD;;AAEDA,EAAAA,KAAK;AACN;;AAED,SAASQ,IAAT,CAAiBF,MAAjB,EAAyCG,KAAzC,EAAmDF,KAAnD,EAAuE;AACrEP,EAAAA,KAAK;AAELH,EAAAA,UAAU,CAACG,KAAD,CAAV,GAAoBM,MAAM,CAACH,OAA3B;;AAEA,MAAIJ,OAAJ,EAAa;AACXD,IAAAA,UAAU,CAACE,KAAD,CAAV,GAAoBO,KAApB;AACD;;AAEDD,EAAAA,MAAM,CAACH,OAAP,GAAiBM,KAAjB;AACD;;AAED,SAASC,qBAAT,GAAiC;AAC/B,MAAIX,OAAJ,EAAa;AACX,QAAIC,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBJ,MAAAA,mBAAmB,CACjB,KADiB,EAEjB,4DAFiB,CAAnB;AAID;AACF;AACF;;AAED,SAASe,8BAAT,GAA0C;AACxC,MAAIZ,OAAJ,EAAa;AACXC,IAAAA,KAAK,GAAG,CAAC,CAAT;AACAH,IAAAA,UAAU,CAACe,MAAX,GAAoB,CAApB;AACAd,IAAAA,UAAU,CAACc,MAAX,GAAoB,CAApB;AACD;AACF;;AAED,SACEX,YADF,EAEEG,OAFF,EAGEC,GAHF,EAIEG,IAJF,EAKE;AACAE,qBANF,EAOEC,8BAPF","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Fiber} from './ReactFiber';\n\nimport warningWithoutStack from 'shared/warningWithoutStack';\n\nexport type StackCursor<T> = {\n  current: T,\n};\n\nconst valueStack: Array<any> = [];\n\nlet fiberStack: Array<Fiber | null>;\n\nif (__DEV__) {\n  fiberStack = [];\n}\n\nlet index = -1;\n\nfunction createCursor<T>(defaultValue: T): StackCursor<T> {\n  return {\n    current: defaultValue,\n  };\n}\n\nfunction isEmpty(): boolean {\n  return index === -1;\n}\n\nfunction pop<T>(cursor: StackCursor<T>, fiber: Fiber): void {\n  if (index < 0) {\n    if (__DEV__) {\n      warningWithoutStack(false, 'Unexpected pop.');\n    }\n    return;\n  }\n\n  if (__DEV__) {\n    if (fiber !== fiberStack[index]) {\n      warningWithoutStack(false, 'Unexpected Fiber popped.');\n    }\n  }\n\n  cursor.current = valueStack[index];\n\n  valueStack[index] = null;\n\n  if (__DEV__) {\n    fiberStack[index] = null;\n  }\n\n  index--;\n}\n\nfunction push<T>(cursor: StackCursor<T>, value: T, fiber: Fiber): void {\n  index++;\n\n  valueStack[index] = cursor.current;\n\n  if (__DEV__) {\n    fiberStack[index] = fiber;\n  }\n\n  cursor.current = value;\n}\n\nfunction checkThatStackIsEmpty() {\n  if (__DEV__) {\n    if (index !== -1) {\n      warningWithoutStack(\n        false,\n        'Expected an empty stack. Something was not reset properly.',\n      );\n    }\n  }\n}\n\nfunction resetStackAfterFatalErrorInDev() {\n  if (__DEV__) {\n    index = -1;\n    valueStack.length = 0;\n    fiberStack.length = 0;\n  }\n}\n\nexport {\n  createCursor,\n  isEmpty,\n  pop,\n  push,\n  // DEV only:\n  checkThatStackIsEmpty,\n  resetStackAfterFatalErrorInDev,\n};\n"]},"metadata":{},"sourceType":"module"}